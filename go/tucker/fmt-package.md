# 4 변수

## 4.1 변수란

```go
package main

import "fmt"

func main() {
	var a = 0
	var msg = "Hello Variable"

	a = 20
	msg = "Good Morning"
	fmt.Println(msg, a)
}
```

프로그램에서 값을 저장하고 변경하고 사용할 때 변수를 사용합니다.

---

## 4.2 변수 선언

변수를 사용하려면 먼저 변수를 선언해야한다. 변수 선언은 컴퓨터에게 **값을 저장할 공간을 마련하라**고 명령을 내리는 것이다. 이것을 `메모리 할당`이라고 한다.

```go
package main

import "fmt"

func main() {
	var minimumWage = 10 // 변수 minimumWage 선언 및 초기화
	var workingHour = 20 // 변수 workingHour 선언 및 초기화

	// 변수 income 선언 및 초기화
	var income = minimumWage * workingHour

	// 변수 minimumWage, workingHour, income 출력
	fmt.Println(minimumWage, workingHour, income)
}
```

---

## 4.3.1 변수의 4가지 속성

* 이름: 프로그래머는 이름을 통해 값이 저장된 메모리 공간에 손쉽게 접근
* 값: 변수가 가리키는 메모리 공간에 저장된 값
* 주소: 변수가 저장된 메모리 공간의 시작 주소
* 타입: 변숫값의 형태 정수, 실수, 문자열 등 다양함 자료형, 데이터 타입이라고도 함

변수 a를 선언하면 컴퓨터는 메모리에 int 타입 크기에 해당하는 공간을 할당하고 그 공간이 위치한 메모리 시작 주소를 a로 지칭한다. 그리고 메모리 공간에 10이라는 값을 복사한다.

```go
var a int = 10
```

변수 a값을 대입 연산자 =를 이용해 50으로 바꾸면 a의 메모리 시작 주소부터 int 타입만큼의 공간에 값 50을 복사한다.

---

## 4.3.2 변수는 이름을 가지고 있다.

### 필수 규칙

* 변수명은 문자, _, 숫자를 사용해 지을 수 있지만 첫 글자는 반드시 문자나 _로 시작해야함 (영어뿐 아니라 한글, 한문 같은 다른 언어 문자도 됨)
* _를 제외한 다른 특수문자(space 포함)를 포함할 수 없음

### 권장 사항

* 변수명은 영문자를 제외한 다른 언어의 문자를 사용하지 않음
* 변수명에 여러 단어가 이어지면 두 번째 단어부터는 대문자로 시작 (카멜 케이스)
* 변수명은 되도록 짧게 잠시 사용되는 로컬 변수는 한 글자를 권장
* 밀줄 _은 일반적으로 사용하지 않음

> 변수가 함수 내부가 아닌 외부에 선언되어 있고 변수명의 첫 번째 글자가 대문자인 변수는 패키지 외부로 공개 (public)

---

## 4.3.3 변수는 타입을 가지고 있다.

메모리 주소는 값이 있는 메모리 시작 주소만을 알려준다. 크기를 알아야지 해당 메모리 주소에서 얼만큼 읽을지 결정한다. 타입을 알면 크기를 알 수 있다. 타입 정보가 없으면 a가 가리키는 공간의 시작 주소는 알지만,
크기는 알 수 없다.

* 숫자: uint8, uint16, uint32, uint64, int8, int16, int32, int64, float32, float64, byte, rune, int, uint
* 불리언: 참과 거짓 두 값만 가지는 타입니다. `bool`로 선언하고 참은 `true`, 거짓은 `false`로 쓴다.
* 문자열: 문자열 타입의 키워드는 string 이다.
* 배열: 같은 타입의 요소들로 이루어진 연속된 메모리 공간을 나타내는 자료구조이다.
* 슬라이스: Go 언어에서 제공하는 가변 길이 배열을 말한다. 배열은 고정 길이로써 한 번 길이가 정해지면 늘리거나 줄일 수 없는 반면 슬라이스는 길이를 늘리거나 줄일 수 있다.
* 구조체: 필드(변수)의 집합 자료구조이다. 보통 상관관계가 있는 데이터를 묶어놓을 때 사용한다. 예를 들어 회원 구조체는 회원ID, 회원명 주소 등의 필드로 구성할 수 있다.
* 포인터: 메모리 주소를 값으로 갖는 타입이다. 포인터를 이용해서 같은 메모리 공간을 가리키는 여러 변수를 만들 수 있다.
* 함수 타입: 함수를 가리키는 타입이다. 다른 말로 함수 포인터라고 말한다. 사용할 함수를 동적으로 바꿀 때 유용하다.
* 인터페이스: 메서드 정의의 집합이다.
* 맵: key 와 value 를 갖는 데이터를 저장해둔 자료구조이다. 키를 사용해 데이터를 찾는 데 특화된 자료구조이다. 쉽게 전화번호부나 사전을 생각하면 된다.
* 채널: 멀티스레드 환경에 특화된 큐 형태 자료구조이다.

> int 16은 16비트 크기를 갖는 부호 있는 정수 타입이다. 크기를 신경 쓰지 않는 경우 보통 int, float64를 사용한다.
> 타입 크기가 클수록 표현할 수 있는 값의 범위가 넓지만 그만큼 메모리를 더 차지한다. 메모리를 절약해 사용해야 하는 경우에는 값의 범위에 딱 맞는 크기의 타입을 사용해야 한다.

--- 

## 4.4 변수 선언의 다른 형태

```go
package main

import "fmt"

func main() {
	var a  = 3 // 기본 형태
	var b int     // 초깃값 생략, 초깃값은 타입별 기본값으로 대체
	var c = 4     //타입 생략, 변수 타입은 우변 값의 타입이 됨
	d := 5        // 선언 대입문 := 을 사용해서 var 키워드와 타입 생략

	fmt.Println(a, b, c, d)
}
```

### 타입별 기본 값

* 모든 정수 타입: 0
* 모든 실수 타입: 0.0
* 불리언: false
* 문자열: ""(빈 문자열)
* 그외: nil(정의되지 않은 메모리 주소를 나타내는 Go 키워드)

### 선언 대입문 :=

```go
var b = 3.1415 // b는 float64 타입으로 자동 지정
c := 365       // c는 int 타입으로 자동 지정
s := "hello world" // s는 string 타입으로 자동 지정
```

---

## 4.5 타입 변환

Go 언어에서는 연산이나 대입에서 타입이 다르면 에러 발생

```go
a := 3               // int
var b float 64 = 3.5 // float64

var c int = b // Error - float64 변수를 int에 대입 불가
d := a * b // Error - 다른 타입인 int 변수와 float64 연산 불가

var e int64 = 7
f := a * e // Error - a는 int 타입, e는 int64 타입으로 같은 정수값이지만 타입이 달라서 연산 불가

var g int = b * 3 // Error - 실수가 정수로 자동으로 바뀌지 않음 
```

타입 변환은 원하는 타입명을 적고 ()로 변화시키고 싶은 변수를 묶어준다.

```go
package main

import "fmt"

func main() {
	a := 3              // int
	var b  = 3.5 // float64

	var c  = int(b)  // float64에서 int로 변환
	d := float64(a * c) // int에서 float64으로 변환

	var e int64 = 7
	f := int64(d) * e // float64에서 int64로 변환

	var g  = int(b * 3) //float64에서 int로 변환 - 3.5 * 3 = 10.5 -> 버림 -> 10
	var h  = int(b) * 3 //float64에서 int로 변환 g와는 값이 다름 - 3.5 -> 버림 -> 3 * 3 = 9
	fmt.Println(g, h, f)
}
```

### 유의점

* 실수 타입에서 정수 타입으로 타입 변환하면 소수점 이하 숫자가 없어진다. (반올림이 아닌 버림)
* 큰 범위를 갖는 타입에서 작은 범위를 갖는 타입으로 변환하면 값이 달라질 수 있다.

```go
package main

import "fmt"

func main() {
	var a int16 = 3456
	var c  = int8(a) // int16타입에서 int8타입으로 변환

	fmt.Println(a) // 3456
	fmt.Println(c) // -128
}
```

`00001101` `10000000` a int 16 = 3456

~~00001101~~ `10000000` c int8 = -128

2바이트 정수 int16에서 1바이트 정수 int8로 변환할 때 상위 1바이트가 없어진다.

---

## 4.7.1 정수 표현

부호 있는 정수 타입을 표현하는 방법은 부호를 표현해야 하기 때문에 첫 뻔째 비트를 부호 비트로 정해서 1이면 음수를, 0이면 양수를 나타낸다. 2바이트 부호있는 15는 2진수로 변환하며 1111이다. 그럼 음수는
어떻게 표현할까? 양수 15에서 부호 비트를 1로 바꿔서 표현할까?

아쉽게도 그렇지 않다. 보수로 표현하게 된다. 왜냐하면 단순한 최상위 비트가 1이냐 0이냐로 판단을 하게 되면 +0 -0 이라는 이상한 개념이 생긴다.

게다가 표현할 수 잇는 숫자가 하나 줄어서 낭비가 발생하기 떄문에 컴퓨터에서 음수를 절댓값의 2의 보수로 표현한다. 2의 보수를 만드는 방법은 모든 비트를 0을 1로, 1을 0으로 바꾸고 나서 1을 더하면 된다.

`0` `000000000001111`

비트 반전

`1` `111111111110000`

+1

`1` `111111111110001` -15

또한 2의 보수로 음수를 표현하면 음수를 별도 처리 없이 바로 더할 수 있는 장점이 있다.

---

## 4.7.2 실수의 표현

소수점이 있는 실수는 1과 2사이에도 무수히 많은 숫자가 있기 때문에 정수 타입처럼 바로 2진수로 변환해서 사용할 수 없다. 그래서 실수를 표현하는 데 특수한 방법을 적용한다. Go 언어는 IEEE-754 표준을
따라 실수를 표현한다. 예를 들어 1024.234는 0.1024234 * 10^4으로 나타낼 수 있고 0.1024234e+04라고 쓰기도 한다. 이 때 1024234가 소수부이고 10의 승수인 4가 지수부이다.
컴퓨터에서 실수는 이렇게 소수부와 지수부를 나눠서 표현한다.

> 컴퓨터는 2진수 이기 때문에 지수부나 소수부를 10진수로 나타내지 않는다. 사실 IEEE-754에서는 더 복잡한 수식을 사용한다.

4 바이트 실수에서는 제일 왼쪽 1비트가 부호 비트로 1이면 음수, 0이면 양수이다. 그뒤 8비트는 지수부를 나타내고 나머지 23비트는 소수부를 나타낸다.

`0` `1000000` `01000000000000000000000`

중요한 점은 모든 실수를 표현할 수 없고 한계가 있다는 점이다. 특히 소수부 비트수가 정해져 있기 때문에 표현할 수 잇는 숫자에 한계가 있다.

* float32: 7자리
* float64: 15자리

Go 언어에서 실숫값을 표현할 때 정확한 값이 아닌 타입이 허용하는 범위에서 가장 가까운 근삿값으로 표현하게된다.

이 자릿수를 넘기면 수가 제대로 표현되지 않는다.

```go
package main

import "fmt"

func main() {
	var a float32 = 1234.523
	var b float32 = 3456.123
	var c = a * b
	var d = c * 3

	fmt.Println(a) // 1234.523
	fmt.Println(b) // 3456.123
	fmt.Println(c) // 4.266663e+06
	fmt.Println(d) // 1.2799989e+07;
}
```

1234.523 * 3456.123 의 정확한 결과는 4266663.334329지만 float32의 7자리 제한에 걸려서 실제 c값은 4266663이 된다. 문제는 여기서 끝나는게 아니라 연산이 누적될수록 오차가
점점 커진다. d의 올바른 값은 12799990.002987이지만 127999890이 출력됐다. 1 미만의 오차가 곱하기 연산 한번으로 100에 가까운 큰 차이를 만들었다. 따라서 회계나 금융처럼 정확한 수치 연산이
필요한 프로그래밍에서는 실수 타입 사용에 주의해야한다.

> 핵심 요약
> 1. 변수는 값을 저장하는 메모리 공간이다. 변수를 사용해서 메모리에 접근하여 값을 조정할 수 있다.
> 2. 변수를 사용하려면 먼저 선언을 해야한다. 변수 선언은 컴퓨터에게 값을 저장할 공간을 메모리에 마련하라고 명령을 내리는거다. 이를 메모리 할당이라고 한다.
> 3. 변수는 4가지 속성을 가지고 있다. 4가지 속성은 이름, 값, 타입, 주소이다.
> 4. 변수 선언 방법은 다양하다. 편의를 고려해 초기값을 생략하거나 타입을 생략하는 등 다양한 선언 방법을 제공한다.
> 5. 타입변환은 한 타입의 값을 변환 가능한 다른 타입으로 변환시키는 것이다. Go 언어는 자동 변환을 지원하지 않기 때문에 연산이나 대입에서 타입 변환을 해줘야한다.
> 6. 숫자 타입은 크기에 따라 표현할 수 잇는 값의 범위가 다르다. 특히 실수 타입은 유효 자릿수가 정해져 있어 주의해서 사용해야 한다.